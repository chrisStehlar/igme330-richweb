(()=>{"use strict";var e={938:(e,t)=>{let o,r,n,a,i,l,s,c;Object.defineProperty(t,"__esModule",{value:!0}),t.analyserNode=t.toggleDistortion=t.toggleLowpass=t.toggleHighpass=t.setVolume=t.loadSoundFile=t.pauseCurrentSound=t.playCurrentSound=t.setupWebaudio=t.audioCtx=void 0;const u=Object.freeze({gain:.5,numSamples:256});t.setupWebaudio=e=>{const d=window.AudioContext;t.audioCtx=o=new d,r=new Audio,h(e),n=o.createMediaElementSource(r),t.analyserNode=a=o.createAnalyser(),a.fftSize=u.numSamples,i=o.createGain(),i.gain.value=u.gain,l=o.createBiquadFilter(),l.type="highshelf",s=o.createBiquadFilter(),s.type="lowshelf",c=o.createWaveShaper(),n.connect(l),l.connect(s),s.connect(c),c.connect(a),a.connect(i),i.connect(o.destination)},t.toggleHighpass=e=>{e?(l.frequency.setValueAtTime(1e3,o.currentTime),l.gain.setValueAtTime(25,o.currentTime)):l.gain.setValueAtTime(0,o.currentTime)},t.toggleLowpass=e=>{e?(s.frequency.setValueAtTime(1e3,o.currentTime),s.gain.setValueAtTime(15,o.currentTime)):s.gain.setValueAtTime(0,o.currentTime)},t.toggleDistortion=(e,t)=>{c.curve=e?d(t):null};const d=(e=20)=>{const t=new Float32Array(256);for(let o=0;o<256;++o){const r=2*o/256-1;t[o]=(Math.PI+e)*r/(Math.PI+e*Math.abs(r))}return t},h=e=>{r.src=e};t.loadSoundFile=h,t.playCurrentSound=()=>{r.play()},t.pauseCurrentSound=()=>{r.pause()},t.setVolume=e=>{e=Number(e),i.gain.value=e}},250:function(e,t,o){var r,n=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,r,n)}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[t.length]=o);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o=r(e),i=0;i<o.length;i++)"default"!==o[i]&&n(t,e,o[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.drawSprite=t.draw=t.setupCanvas=void 0;const l=i(o(256));let s,c,u,d,h,g;t.setupCanvas=(e,t)=>{s=e.getContext("2d"),c=e.width,u=e.height,d=l.getLinearGradient(s,0,0,0,u,[{percent:0,color:"yellow"},{percent:.3,color:"orange"},{percent:.6,color:"red"},{percent:.8,color:"darkred"},{percent:1,color:"black"}]),h=t,g=new Uint8Array(h.fftSize/2)},t.draw=(e={})=>{if("frequency"==e.visualMode?h.getByteFrequencyData(g):h.getByteTimeDomainData(g),s.save(),s.fillStyle="black",s.globalAlpha=.1,s.fillRect(0,0,c,u),s.restore(),e.showGradient&&(s.save(),s.fillStyle=d,s.globalAlpha=.3,s.fillRect(0,0,c,u),s.restore()),e.showBars){const e=4,t=5,o=(c-g.length*e-2*t)/g.length,r=200,n=100;s.save(),s.fillStyle="rgba(255,255,255, 0.5)",s.strokeStyle="rgba(0, 0, 0, 0.5)";for(let a=0;a<g.length;a++)s.fillStyle=a%2==0?"rgba(255,255,255, 0.5)":"rgba(0,0,0, 0.5)",s.fillRect(t+a*(o+e),n+256-g[a],o,r),s.strokeRect(t+a*(o+e),n+256-g[a],o,r);s.restore()}if(e.showCircles){const e=u/4;s.save(),s.globalAlpha=.5;for(let t=0;t<g.length;t++){const o=g[t]/255,r=o*e;s.beginPath(),s.fillStyle=l.makeColor(255,255,0,.34-o/3),s.arc(c/2,u/2,r,0,2*Math.PI,!1),s.fill(),s.closePath(),s.beginPath(),s.fillStyle=l.makeColor(0,0,0,.1-o/10),s.arc(c/2,u/2,1.5*r,0,2*Math.PI,!1),s.fill(),s.closePath(),s.save(),s.beginPath(),s.fillStyle=l.makeColor(255,0,0,.5-o/5),s.arc(c/2,u/2,.5*r,0,2*Math.PI,!1),s.fill(),s.closePath(),s.restore()}s.restore()}const t=s.getImageData(0,0,c,u),o=t.data,r=o.length,n=t.width;for(let t=0;t<r;t+=4)if(e.showNoise&&Math.random()<.05&&(o[t]=o[t+1]=o[t+2]=0,o[t]=0),e.showInvert){const e=o[t],r=o[t+1],n=o[t+2];o[t]=255-e,o[t+1]=255-r,o[t+2]=255-n}if(e.showEmboss)for(let e=0;e<r;e++)e%4!=3&&(o[e]=127+2*o[e]-o[e+4]-o[e+4*n]);s.putImageData(t,0,0)},t.drawSprite=e=>{e.draw(s)}},927:function(e,t,o){var r,n=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,r,n)}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[t.length]=o);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o=r(e),i=0;i<o.length;i++)"default"!==o[i]&&n(t,e,o[i]);return a(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const l=i(o(256)),s=i(o(938)),c=i(o(250)),u=o(751),d={showGradient:!0,showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1,visualMode:"frequency",showSprites:!0},h={trebleActive:!1,bassActive:!1,distortionActive:!1},g=new u.Sprite(200,200,"media/hippo.png",5),p=new u.Sprite(300,100,"media/giraffe.png",-3);let y=!1;t.init=()=>{console.log("init called"),console.log(`Testing utils.getRandomColor() import: ${l.getRandomColor()}`),s.setupWebaudio("media/Joe Satriani - Sahara.mp3"),m();const e=document.querySelector("canvas");v(e),c.setupCanvas(e,s.analyserNode),f()};const m=()=>{let e;const t=new XMLHttpRequest;t.onload=t=>{let o=t.target.responseText;try{if(e=JSON.parse(o),null!=e){const t=document.querySelector("h1");t&&(t.innerHTML=e.title);let o=document.querySelector("#track-select");e.audioFiles.forEach((e=>{let t=document.createElement("option");t.value="media/"+e.name,t.text=e.name.replace(".mp3",""),o&&o.appendChild(t)}));const r=document.querySelector("#instructions");r&&(r.innerHTML=e.instructions)}}catch(e){return void console.log("Could not parse the JSON.")}},t.open("GET","data/av-data.json"),t.send()},v=e=>{const t=document.querySelector("#btn-fullscreen"),o=document.querySelector("#btn-play");t.onclick=t=>{console.log("goFullscreen() called"),l.goFullscreen(e)},o.onclick=e=>{"suspended"==s.audioCtx.state&&s.audioCtx.resume(),"no"==e.target.dataset.playing?(s.playCurrentSound(),e.target.dataset.playing="yes",y=!0):(s.pauseCurrentSound(),e.target.dataset.playing="no",y=!1)};const r=document.querySelector("#volume-slider"),n=document.querySelector("#volume-label");r.oninput=e=>{const t=Number(e.target.value);s.setVolume(t),n.innerHTML=Math.round(t/2*100).toString();const o=Math.round(t/2*100);g.velocity={x:o/18*Math.sign(g.velocity.x),y:o/16*Math.sign(g.velocity.x)},p.velocity={x:o/16*Math.sign(g.velocity.x),y:o/18*Math.sign(g.velocity.x)}},r.dispatchEvent(new Event("input")),document.querySelector("#track-select").onchange=e=>{s.loadSoundFile(e.target.value),"yes"==o.dataset.playing&&o.dispatchEvent(new MouseEvent("click"))};const a=document.querySelector("#gradient-cb"),i=document.querySelector("#bars-cb"),c=document.querySelector("#circles-cb"),u=document.querySelector("#noise-cb"),m=document.querySelector("#invert-cb"),v=document.querySelector("#emboss-cb"),f=document.querySelector("#sprites-cb");a.onchange=e=>{d.showGradient=!d.showGradient},i.onchange=e=>{d.showBars=!d.showBars},c.onchange=e=>{d.showCircles=!d.showCircles},u.onchange=e=>{d.showNoise=!d.showNoise},m.onchange=e=>{d.showInvert=!d.showInvert},v.onchange=e=>{d.showEmboss=!d.showEmboss},f.onchange=e=>{d.showSprites=!d.showSprites,g.y=200,p.y=300};const b=document.querySelector("#distortion-volume-slider"),S=document.querySelector("#distortion-volume-label");S.innerHTML=Math.round(Number(b.value)/2*100).toString(),b.oninput=e=>{const t=Number(e.target.value),o=Math.round(t/2*100);S.innerHTML=o.toString(),s.toggleDistortion(h.distortionActive,o)},document.querySelector("#distortion-cb").onchange=e=>{h.distortionActive=!h.distortionActive;const t=Number(e.target.value),o=Math.round(t/2*100);S.innerHTML=o.toString(),s.toggleDistortion(h.distortionActive,o)};const w=document.querySelector("#treble-cb"),M=document.querySelector("#bass-cb");w.onchange=e=>{h.trebleActive=!h.trebleActive,s.toggleHighpass(h.trebleActive)},M.onchange=e=>{h.bassActive=!h.bassActive,s.toggleHighpass(h.bassActive)},document.querySelector("#visualization-mode").onchange=e=>{const t=e.target;d.visualMode=t.value}},f=()=>{setTimeout(f,1/60),c.draw(d),d.showSprites&&(c.drawSprite(g),c.drawSprite(p),y&&(g.update(),p.update()))}},751:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Sprite=void 0,t.Sprite=class{constructor(e,t,o,r){this.update=()=>{this.x+=this.velocity.x,this.y+=this.velocity.y,(this.y>300||this.y<-100)&&(this.velocity.y=-this.velocity.y),(this.x>600||this.x<-100)&&(this.x=Math.floor(401*Math.random()),this.velocity.x=-this.velocity.x)},this.draw=e=>{e.drawImage(this.image,this.x,this.y)},this.x=e,this.y=t,this.image=new Image,this.image.src=o,this.velocity={x:r,y:-r},console.log("Sprite created at position:",e,t)}}},256:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.goFullscreen=t.getLinearGradient=t.getRandomColor=t.makeColor=void 0,t.makeColor=(e,t,o,r=1)=>`rgba(${e},${t},${o},${r})`,t.getRandomColor=()=>{const e=()=>185*Math.random()+35;return`rgba(${e()},${e()},${e()},1)`},t.getLinearGradient=(e,t,o,r,n,a)=>{let i=e.createLinearGradient(t,o,r,n);for(let e of a)i.addColorStop(e.percent,e.color);return i},t.goFullscreen=e=>{e.requestFullscreen&&e.requestFullscreen()}}},t={};!function o(r){var n=t[r];if(void 0!==n)return n.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,o),a.exports}(927)})();
//# sourceMappingURL=bundle.js.map